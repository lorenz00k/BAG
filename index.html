<!doctype html>
<html lang="de" data-page="index">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Betriebsanlagengenehmigung – Schnellcheck</title>
  <meta name="description" content="Minimaler Schnell-Check: Brauche ich eine Betriebsanlagengenehmigung in Wien?"/>
  <link rel="stylesheet" href="assets/styles.css"/>

  <!-- Google Analytics 4 + Consent Mode v2 -->
  <script>
    // DataLayer & gtag
    window.dataLayer = window.dataLayer || [];
    function gtag(){ dataLayer.push(arguments); }

    // 1) Default: alles verweigert
    gtag('consent', 'default', {
      ad_user_data: 'denied',
      ad_personalization: 'denied',
      ad_storage: 'denied',
      analytics_storage: 'denied'
    });

    // 2) Bereits getroffene Entscheidung anwenden (aus localStorage)
    try {
      var saved = localStorage.getItem('ga_consent');
      if (saved === 'granted' || saved === 'denied') {
        gtag('consent', 'update', { analytics_storage: saved });
      }
    } catch (e) { /* ignore */ }
  </script>

  <!-- GA4: Mess-ID EINMAL eintragen (deine echte ID) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-RLN7N8WFZF"></script>
  <script>
    gtag('js', new Date());
    gtag('config', 'G-RLN7N8WFZF');
  </script>
</head>
<body>
  <div class="container">
    <header class="header">
      <a class="brand" href="index.html" aria-label="Start">
        <!-- inline logo -->
        <svg width="28" height="28" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <rect x="2" y="2" width="20" height="20" rx="6" stroke="#7ee787" stroke-width="2"/>
          <path d="M7 12h10M12 7v10" stroke="#7ee787" stroke-width="2" stroke-linecap="round"/>
        </svg>
        <strong>Genehmigungs-Check</strong>
      </a>
      <div class="lang">
        <label for="langSel" class="sr" aria-hidden="true"></label>
        <span data-i18n-common="lang">Sprache</span>
        <select id="langSel" aria-label="Sprache wählen">
          <option value="de">Deutsch</option>
          <option value="en">English</option>
        </select>
      </div>
    </header>

    <main class="main">
      <div class="card">
        <h1 id="hero">Betriebsanlagengenehmigung – brauche ich eine?</h1>
        <p id="lead" class="lead">Eine schlanke Seite, um erste Anhaltspunkte zu bekommen. Kein Ersatz für Rechtsberatung.</p>
        <div class="buttons">
          <a id="cta1" class="button primary" href="check.html">Schnell-Check starten</a>
          <a id="cta2" class="button" href="process.html">Infos zum Verfahren</a>
        </div>
      </div>
      <p><small id="foot">© 2025 – Minimaler Genehmigungs-Check (ohne Gewähr)</small></p>
    </main>

    <footer>
      <nav>
        <a href="impressum.html" data-i18n-common="imp">Impressum</a>
        <a href="datenschutz.html" data-i18n-common="priv">Datenschutz</a>
      </nav>
    </footer>
  </div>

  <script src="js/app.js"></script>

  <!-- Consent-Banner (einfach) -->
  <div id="consent-banner" style="
    position:fixed;bottom:0;left:0;right:0;
    background:#222;color:#fff;padding:16px;text-align:center;z-index:1000;">
    Diese Website verwendet Google Analytics (GA4) zur Reichweitenmessung.
    <button id="accept" style="margin-left:8px;">Akzeptieren</button>
    <button id="decline" style="margin-left:4px;">Ablehnen</button>
  </div>

  <script>
    (function(){
      function hideBanner(){
        var b = document.getElementById('consent-banner');
        if (b) b.remove();
      }

      // Banner ausblenden, wenn bereits entschieden
      try {
        var saved = localStorage.getItem('ga_consent');
        if (saved === 'granted' || saved === 'denied') hideBanner();
      } catch(e){}

      document.getElementById('accept').onclick = function(){
        gtag('consent', 'update', { analytics_storage: 'granted' });
        try { localStorage.setItem('ga_consent','granted'); } catch(e){}
        // verpassten Pageview nachholen
        gtag('event','page_view', {
          page_location: location.href,
          page_path: location.pathname,
          page_title: document.title
        });
        hideBanner();
      };
      document.getElementById('decline').onclick = function(){
        gtag('consent', 'update', { analytics_storage: 'denied' });
        try { localStorage.setItem('ga_consent','denied'); } catch(e){}
        hideBanner();
      };
    })();
  </script>

  <!-- CTA-Tracking nur auf der Startseite -->
  <script>
    document.addEventListener('DOMContentLoaded', function () {
      var cta1 = document.getElementById('cta1');
      var cta2 = document.getElementById('cta2');

      if (cta1) cta1.addEventListener('click', function(){
        window.gtag && gtag('event', 'cta_click', {
          event_category: 'interaction',
          event_label: 'quick_check'
        });
      });
      if (cta2) cta2.addEventListener('click', function(){
        window.gtag && gtag('event', 'cta_click', {
          event_category: 'interaction',
          event_label: 'process_info'
        });
      });
    });
  </script>
</body>
</html>
